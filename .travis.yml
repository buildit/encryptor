language: java
env:
  global:
  - GIT_USERNAME=Travis CI
  - GIT_EMAIL=builds@travis-ci.com
  - TAG=$(./pipeline.sh getProperty version gradle.properties)
  - RELEASE_FILE=build/libs/encryptor-$TAG.jar
  - RELEASE_POM=build/pom.xml
  - LAST_COMMIT_MESSAGE=$(git log -1 --pretty=%B | tr -d '\n')
  - CD_COMMIT_MESSAGE='[travis] Bump version number'
  - GITHUB_USER=dermotmburke
  - secure: HSvOEEzsnlQxNh6dhYUpP4hSsOL78snqelIepehDB5w7JHt5PgJd9Z5x8SaPneGNE9GF7NR4kmnQ5wWUPeK0UAp9oHzIVz9RW5IHCgwF3MVqKQAz57z20KOUKYyLx08Kdqli8NZLTNV/F6E461UJp9hKU/nAWYiN7QmzwutkLWrda/X1UOEjqa0/xNp4K6pc//fi/TG//2qW1PW3LeiGt5Y2uV0Re90q/S0wykwKS/tF4LG4XIlGREJeCF4itn+vTlQv+kbVDAFKIdexUZQg0jPFrWgx39ypc7WNVUH3hT/EKlanwt0K2KhCv3VAWDLewFm9BxhrFPczC1x83kltF9YudxWq/SkMB20gWHipYTqMzT6OBKMCl9ZtvMHQW12v7h/+gws2U5Q3deTK2I4JOalV0nW26sxBrTVKK8EIuNYdoVldjk0dwtpJFIAr5NnB9ExaBNh2UlnM9DZwxpR084ZfjylgbYmxWa3mRhRoAXn1qeY2s2FEnlTEG4LadHYO55f7fGspvH7AmwkoK2QzoN0MIqQQMdgmjAzWf3XkUssjNxDkfOwdlFB7yhLK/HkWQofyVtkS2ixVRgz7gM/VSXKAui0Z1Lpocylq4MB8fdTALrkv83843e0Y1/eMgR8Ybj/ZnfLyxcGvDtEsNujRHike0JhxIr6Bovc7lx6zqBM=
script:
- ./pipeline.sh build
before_deploy:
- ./pipeline.sh tag
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: h0kv9rXt90x/A5Rz848tHvgJy5+GkRuSKcphpdn8ELRe3cZvl7zzmz9UsAUgjNpZXGGg0zI6nLfNkYSYWRDWU98IrQQrqsJBV1e2NRl11rNRlhAAC0jEbOhFyYOdgn9jyVdQ10j90/HF/aoXmyzSUk/RCWfP+02hR+5jSUV3lRzxvRcRoFERN1gaEbdRYD3ZpTut5j+kW/4wUZqgWG4gq6UDWXlu2xZKpKLWArfaUZy/V8vNrLvdHh6y5xxtpd1ycjB4SDlh9GoIKfQ1SGE+7sjZs7dPiYxRJK71Wj3ugnRuQkRJB87iEKJ5JOW7Io8pkxp9+j6/50mF7obU66VYPXnIFGv0qYh7LMBsZnQHJJR/b58yZqooQqRow7Mw6PYDnmBrshK+SwXzw28v2AYO4FWxQSGHLD1SQPROXSRuVJnVPATzdKhNGThVTRlvQoznzAng+ovTqGcVvqD7gjdRUL7Ko0uC//LbN2Nj2bJJ2l12ApVBZPq07tqpMo25+fE0NbWpBn4nSVcrZcqcX0a5VxV/VyknUZe6uyMcdagYrRDCKSwSxAnTtSQ5xtnNugfBOJTyR+3vrdBRgFHq0Je8F/IwWwB+m3EO3HnaIrLX2moYaSnJmwnGHQ1g2thq5loP6MQ0jmMCTMl8rwW0z6/KNfTwsxwp4TCxIWFHb6vDyg4=
  file:
    - "${RELEASE_FILE}"
    - "${RELEASE_POM}"
  on:
    branch: master
    tags: false
    condition: '"${LAST_COMMIT_MESSAGE}" != "${CD_COMMIT_MESSAGE}"'
after_deploy:
- ./pipeline.sh bump